# Informe Técnico de Vulnerabilidad - IDOR en Servicios Gubernamentales

## 📊 Resumen Ejecutivo

**Clasificación**: Vulnerabilidad de Seguridad Crítica  
**Tipo**: IDOR (Insecure Direct Object Reference)  
**CVSS v3.1**: 8.1 (High)  
**Estado**: Reportada y posteriormente mitigada por el ente gubernamental  
**Fecha de descubrimiento**: Julio 2025  
**Fecha de mitigación**: Agosto 2025  

## 🔍 Descripción Técnica de la Vulnerabilidad

### Tipo de Vulnerabilidad: IDOR (Insecure Direct Object Reference)

**CWE-639**: Autorización por medio de control de acceso controlado por el usuario  
**CWE-284**: Control de acceso inadecuado  
**OWASP Top 10 2021**: A01 - Broken Access Control  

### Definición Técnica

Una vulnerabilidad IDOR ocurre cuando una aplicación proporciona acceso directo a objetos basado en entrada proporcionada por el usuario. Como resultado de esta vulnerabilidad, los atacantes pueden eludir la autorización y acceder a recursos en el sistema directamente.

## 🎯 Vectores de Ataque Identificados

### Vector Principal: Enumeración de Cédulas

```
Método: POST
Endpoint: [REDACTADO]/consulta-formulario
Parámetros: {
  "cedula": "[NUMERO_CEDULA]",
  "tipoDocumento": "CI"
}
```

### Comportamiento Observado

1. **Sin Autenticación**: El endpoint no requiere autenticación previa
2. **Sin Autorización**: No valida que el solicitante tenga derecho a consultar la cédula
3. **Sin Rate Limiting**: Permite consultas masivas automatizadas
4. **Respuesta Determinística**: Retorna datos consistentes para cédulas válidas

### Datos Expuestos

La vulnerabilidad permitía acceder a:
- ✅ Nombres completos de ciudadanos
- ✅ Fechas de nacimiento
- ✅ Información demográfica
- ✅ Metadatos de registro
- ❌ No se observó exposición de datos más sensibles (direcciones, teléfonos)

## 🔬 Análisis de Impacto

### Impacto en Confidencialidad: **ALTO**
- Exposición masiva de datos personales de ciudadanos uruguayos
- Posibilidad de enumerar información de toda la población
- Violación de la Ley Nº 18.331 de Protección de Datos Personales

### Impacto en Integridad: **BAJO**
- No se identificó capacidad de modificar datos
- Solo lectura de información

### Impacto en Disponibilidad: **MEDIO**
- Potencial para ataques de denegación de servicio
- Sobrecarga del sistema con consultas automatizadas

## 🛡️ Controles de Seguridad Ausentes

### Controles de Autenticación
- ❌ **Ausencia de login**: No requiere identificación del usuario
- ❌ **Sin tokens de sesión**: No mantiene estado de autenticación
- ❌ **Sin certificados**: No utiliza autenticación por certificados

### Controles de Autorización
- ❌ **Sin validación de legitimidad**: No verifica derecho a consultar
- ❌ **Sin lista de autorización**: No mantiene lista de usuarios autorizados
- ❌ **Sin roles/permisos**: No implementa RBAC (Role-Based Access Control)

### Controles Técnicos
- ❌ **Sin rate limiting**: Permite consultas ilimitadas
- ❌ **Sin CAPTCHA**: No previene automatización
- ❌ **Sin logging**: No registra consultas para auditoría
- ❌ **Sin alertas**: No detecta patrones sospechosos

## 🔧 Mitigaciones Recomendadas

### Controles de Seguridad Inmediatos (Nivel 1)

```yaml
Autenticación:
  - Implementar login obligatorio
  - Tokens de sesión seguros
  - MFA para usuarios administrativos

Rate Limiting:
  - Máximo 10 consultas por hora por usuario
  - Bloqueo temporal por exceso de consultas
  - Lista negra de IPs sospechosas

Logging:
  - Registro de todas las consultas
  - Alertas por patrones anómalos
  - Retención de logs por 2 años
```

### Controles de Autorización (Nivel 2)

```yaml
Validación de Legitimidad:
  - Justificación obligatoria para consultas
  - Aprobación previa para acceso masivo
  - Verificación de identidad del solicitante

RBAC Implementation:
  - Roles: Ciudadano, Funcionario, Administrador
  - Permisos granulares por tipo de consulta
  - Auditoría de asignación de roles
```

### Controles Avanzados (Nivel 3)

```yaml
Protección de Datos:
  - Pseudonimización de datos sensibles
  - Encriptación en tránsito y reposo
  - Tokenización de identificadores

Monitoreo:
  - SIEM integration
  - ML para detección de anomalías
  - Alertas en tiempo real
```

## 📋 Cronología del Incidente

| Fecha | Evento | Responsable | Estado |
|-------|--------|-------------|--------|
| **Julio 2025** | Descubrimiento de vulnerabilidad | Investigador independiente | ✅ |
| **Julio 2025** | Intento de divulgación responsable | Investigador | ❌ Sin respuesta |
| **Julio 2025** | Desarrollo de PoC público | Investigador | ✅ |
| **Agosto 2025** | Publicación de proyecto educativo | Investigador | ✅ |
| **Agosto 2025** | Mitigación por parte del ente | Gobierno | ✅ |

## 🧪 Metodología de Testing

### Herramientas Utilizadas
- **Burp Suite**: Análisis de tráfico HTTP
- **Postman**: Testing de APIs
- **Scripts Python**: Automatización de pruebas
- **Browser DevTools**: Análisis de frontend

### Approach de Testing Ético
1. **Reconocimiento pasivo**: Solo información pública
2. **Testing limitado**: Máximo 5 consultas de prueba
3. **Datos de prueba**: Solo cédulas propias o públicas
4. **Sin exfiltración**: No almacenamiento de datos sensibles

## 📊 Métricas de Vulnerabilidad

### CVSS v3.1 Score: 8.1 (High)

```
AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L
```

**Desglose**:
- **Attack Vector (AV)**: Network (N) - Explotable remotamente
- **Attack Complexity (AC)**: Low (L) - No requiere condiciones especiales
- **Privileges Required (PR)**: None (N) - Sin autenticación requerida
- **User Interaction (UI)**: None (N) - Totalmente automatizable
- **Scope (S)**: Unchanged (U) - Impacto en el mismo contexto
- **Confidentiality (C)**: High (H) - Acceso total a datos
- **Integrity (I)**: None (N) - Sin capacidad de modificación
- **Availability (A)**: Low (L) - Potencial DoS

## 🌍 Contexto Regulatorio

### Normativa Uruguaya Aplicable

**Ley Nº 18.331 - Protección de Datos Personales**:
- Artículo 4: Principio de licitud del tratamiento
- Artículo 8: Consentimiento del titular
- Artículo 11: Seguridad de los datos

**Ley Nº 20.327 - Ley de Ciberdelito**:
- Artículo 6: Acceso no autorizado a sistemas informáticos
- Artículo 8: Vulneración de sistemas informáticos

### Estándares Internacionales

**ISO 27001**: Gestión de Seguridad de la Información
**NIST Cybersecurity Framework**: Identificar, Proteger, Detectar, Responder, Recuperar
**GDPR**: Artículo 32 - Seguridad del tratamiento

## 🎓 Valor Educativo

### Lecciones Aprendidas

1. **Importancia de los VDP**: Los programas de divulgación responsable son esenciales
2. **Seguridad por diseño**: Los controles deben implementarse desde el desarrollo
3. **Principio de menor privilegio**: Solo otorgar acceso mínimo necesario
4. **Monitoreo continuo**: La detección temprana es crucial

### Recomendaciones para el Sector Público

1. **Establecer VDP gubernamentales**: Canales oficiales para reportes
2. **Auditorías regulares**: Testing de penetración periódico
3. **Capacitación en seguridad**: Desarrollo seguro para equipos técnicos
4. **Cultura de seguridad**: Promover reporte interno de vulnerabilidades

## 📞 Referencias y Recursos

### Documentación Técnica
- **OWASP IDOR Guide**: https://owasp.org/www-community/vulnerabilities/
- **CWE-639**: https://cwe.mitre.org/data/definitions/639.html
- **CVSS Calculator**: https://www.first.org/cvss/calculator/3.1

### Marco Legal Uruguay
- **Ley 18.331**: https://www.impo.com.uy/bases/leyes/18331-2008
- **Ley 20.327**: https://www.impo.com.uy/bases/leyes/20327-2024
- **AGESIC**: https://www.gub.uy/agencia-gobierno-electronico-sociedad-informacion-conocimiento/

---

> **⚠️ Descargo Legal**: Este informe se presenta únicamente con fines educativos y de concientización sobre seguridad informática. Todas las actividades de testing se realizaron dentro del marco de la investigación responsable de vulnerabilidades. No se accedió, almacenó o distribuyó información personal de ciudadanos durante la investigación.

---

**📅 Documento preparado**: Agosto 2025  
**👨‍💻 Investigador responsable**: [REDACTADO]  
**🔍 Metodología**: Ethical Hacking & Responsible Disclosure  
**📋 Estado actual**: Vulnerabilidad mitigada por el ente gubernamental
