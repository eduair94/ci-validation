# Informe TÃ©cnico de Vulnerabilidad - IDOR en Servicios Gubernamentales

## ğŸ“Š Resumen Ejecutivo

**ClasificaciÃ³n**: Vulnerabilidad de Seguridad CrÃ­tica  
**Tipo**: IDOR (Insecure Direct Object Reference)  
**CVSS v3.1**: 8.1 (High)  
**Estado**: Reportada y posteriormente mitigada por el ente gubernamental  
**Fecha de descubrimiento**: Julio 2025  
**Fecha de mitigaciÃ³n**: Agosto 2025  

## ğŸ” DescripciÃ³n TÃ©cnica de la Vulnerabilidad

### Tipo de Vulnerabilidad: IDOR (Insecure Direct Object Reference)

**CWE-639**: AutorizaciÃ³n por medio de control de acceso controlado por el usuario  
**CWE-284**: Control de acceso inadecuado  
**OWASP Top 10 2021**: A01 - Broken Access Control  

### DefiniciÃ³n TÃ©cnica

Una vulnerabilidad IDOR ocurre cuando una aplicaciÃ³n proporciona acceso directo a objetos basado en entrada proporcionada por el usuario. Como resultado de esta vulnerabilidad, los atacantes pueden eludir la autorizaciÃ³n y acceder a recursos en el sistema directamente.

## ğŸ¯ Vectores de Ataque Identificados

### Vector Principal: EnumeraciÃ³n de CÃ©dulas

```
MÃ©todo: POST
Endpoint: [REDACTADO]/consulta-formulario
ParÃ¡metros: {
  "cedula": "[NUMERO_CEDULA]",
  "tipoDocumento": "CI"
}
```

### Comportamiento Observado

1. **Sin AutenticaciÃ³n**: El endpoint no requiere autenticaciÃ³n previa
2. **Sin AutorizaciÃ³n**: No valida que el solicitante tenga derecho a consultar la cÃ©dula
3. **Sin Rate Limiting**: Permite consultas masivas automatizadas
4. **Respuesta DeterminÃ­stica**: Retorna datos consistentes para cÃ©dulas vÃ¡lidas

### Datos Expuestos

La vulnerabilidad permitÃ­a acceder a:
- âœ… Nombres completos de ciudadanos
- âœ… Fechas de nacimiento
- âœ… InformaciÃ³n demogrÃ¡fica
- âœ… Metadatos de registro
- âŒ No se observÃ³ exposiciÃ³n de datos mÃ¡s sensibles (direcciones, telÃ©fonos)

## ğŸ”¬ AnÃ¡lisis de Impacto

### Impacto en Confidencialidad: **ALTO**
- ExposiciÃ³n masiva de datos personales de ciudadanos uruguayos
- Posibilidad de enumerar informaciÃ³n de toda la poblaciÃ³n
- ViolaciÃ³n de la Ley NÂº 18.331 de ProtecciÃ³n de Datos Personales

### Impacto en Integridad: **BAJO**
- No se identificÃ³ capacidad de modificar datos
- Solo lectura de informaciÃ³n

### Impacto en Disponibilidad: **MEDIO**
- Potencial para ataques de denegaciÃ³n de servicio
- Sobrecarga del sistema con consultas automatizadas

## ğŸ›¡ï¸ Controles de Seguridad Ausentes

### Controles de AutenticaciÃ³n
- âŒ **Ausencia de login**: No requiere identificaciÃ³n del usuario
- âŒ **Sin tokens de sesiÃ³n**: No mantiene estado de autenticaciÃ³n
- âŒ **Sin certificados**: No utiliza autenticaciÃ³n por certificados

### Controles de AutorizaciÃ³n
- âŒ **Sin validaciÃ³n de legitimidad**: No verifica derecho a consultar
- âŒ **Sin lista de autorizaciÃ³n**: No mantiene lista de usuarios autorizados
- âŒ **Sin roles/permisos**: No implementa RBAC (Role-Based Access Control)

### Controles TÃ©cnicos
- âŒ **Sin rate limiting**: Permite consultas ilimitadas
- âŒ **Sin CAPTCHA**: No previene automatizaciÃ³n
- âŒ **Sin logging**: No registra consultas para auditorÃ­a
- âŒ **Sin alertas**: No detecta patrones sospechosos

## ğŸ”§ Mitigaciones Recomendadas

### Controles de Seguridad Inmediatos (Nivel 1)

```yaml
AutenticaciÃ³n:
  - Implementar login obligatorio
  - Tokens de sesiÃ³n seguros
  - MFA para usuarios administrativos

Rate Limiting:
  - MÃ¡ximo 10 consultas por hora por usuario
  - Bloqueo temporal por exceso de consultas
  - Lista negra de IPs sospechosas

Logging:
  - Registro de todas las consultas
  - Alertas por patrones anÃ³malos
  - RetenciÃ³n de logs por 2 aÃ±os
```

### Controles de AutorizaciÃ³n (Nivel 2)

```yaml
ValidaciÃ³n de Legitimidad:
  - JustificaciÃ³n obligatoria para consultas
  - AprobaciÃ³n previa para acceso masivo
  - VerificaciÃ³n de identidad del solicitante

RBAC Implementation:
  - Roles: Ciudadano, Funcionario, Administrador
  - Permisos granulares por tipo de consulta
  - AuditorÃ­a de asignaciÃ³n de roles
```

### Controles Avanzados (Nivel 3)

```yaml
ProtecciÃ³n de Datos:
  - PseudonimizaciÃ³n de datos sensibles
  - EncriptaciÃ³n en trÃ¡nsito y reposo
  - TokenizaciÃ³n de identificadores

Monitoreo:
  - SIEM integration
  - ML para detecciÃ³n de anomalÃ­as
  - Alertas en tiempo real
```

## ğŸ“‹ CronologÃ­a del Incidente

| Fecha | Evento | Responsable | Estado |
|-------|--------|-------------|--------|
| **Julio 2025** | Descubrimiento de vulnerabilidad | Investigador independiente | âœ… |
| **Julio 2025** | Intento de divulgaciÃ³n responsable | Investigador | âŒ Sin respuesta |
| **Julio 2025** | Desarrollo de PoC pÃºblico | Investigador | âœ… |
| **Agosto 2025** | PublicaciÃ³n de proyecto educativo | Investigador | âœ… |
| **Agosto 2025** | MitigaciÃ³n por parte del ente | Gobierno | âœ… |

## ğŸ§ª MetodologÃ­a de Testing

### Herramientas Utilizadas
- **Burp Suite**: AnÃ¡lisis de trÃ¡fico HTTP
- **Postman**: Testing de APIs
- **Scripts Python**: AutomatizaciÃ³n de pruebas
- **Browser DevTools**: AnÃ¡lisis de frontend

### Approach de Testing Ã‰tico
1. **Reconocimiento pasivo**: Solo informaciÃ³n pÃºblica
2. **Testing limitado**: MÃ¡ximo 5 consultas de prueba
3. **Datos de prueba**: Solo cÃ©dulas propias o pÃºblicas
4. **Sin exfiltraciÃ³n**: No almacenamiento de datos sensibles

## ğŸ“Š MÃ©tricas de Vulnerabilidad

### CVSS v3.1 Score: 8.1 (High)

```
AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:L
```

**Desglose**:
- **Attack Vector (AV)**: Network (N) - Explotable remotamente
- **Attack Complexity (AC)**: Low (L) - No requiere condiciones especiales
- **Privileges Required (PR)**: None (N) - Sin autenticaciÃ³n requerida
- **User Interaction (UI)**: None (N) - Totalmente automatizable
- **Scope (S)**: Unchanged (U) - Impacto en el mismo contexto
- **Confidentiality (C)**: High (H) - Acceso total a datos
- **Integrity (I)**: None (N) - Sin capacidad de modificaciÃ³n
- **Availability (A)**: Low (L) - Potencial DoS

## ğŸŒ Contexto Regulatorio

### Normativa Uruguaya Aplicable

**Ley NÂº 18.331 - ProtecciÃ³n de Datos Personales**:
- ArtÃ­culo 4: Principio de licitud del tratamiento
- ArtÃ­culo 8: Consentimiento del titular
- ArtÃ­culo 11: Seguridad de los datos

**Ley NÂº 20.327 - Ley de Ciberdelito**:
- ArtÃ­culo 6: Acceso no autorizado a sistemas informÃ¡ticos
- ArtÃ­culo 8: VulneraciÃ³n de sistemas informÃ¡ticos

### EstÃ¡ndares Internacionales

**ISO 27001**: GestiÃ³n de Seguridad de la InformaciÃ³n
**NIST Cybersecurity Framework**: Identificar, Proteger, Detectar, Responder, Recuperar
**GDPR**: ArtÃ­culo 32 - Seguridad del tratamiento

## ğŸ“ Valor Educativo

### Lecciones Aprendidas

1. **Importancia de los VDP**: Los programas de divulgaciÃ³n responsable son esenciales
2. **Seguridad por diseÃ±o**: Los controles deben implementarse desde el desarrollo
3. **Principio de menor privilegio**: Solo otorgar acceso mÃ­nimo necesario
4. **Monitoreo continuo**: La detecciÃ³n temprana es crucial

### Recomendaciones para el Sector PÃºblico

1. **Establecer VDP gubernamentales**: Canales oficiales para reportes
2. **AuditorÃ­as regulares**: Testing de penetraciÃ³n periÃ³dico
3. **CapacitaciÃ³n en seguridad**: Desarrollo seguro para equipos tÃ©cnicos
4. **Cultura de seguridad**: Promover reporte interno de vulnerabilidades

## ğŸ“ Referencias y Recursos

### DocumentaciÃ³n TÃ©cnica
- **OWASP IDOR Guide**: https://owasp.org/www-community/vulnerabilities/
- **CWE-639**: https://cwe.mitre.org/data/definitions/639.html
- **CVSS Calculator**: https://www.first.org/cvss/calculator/3.1

### Marco Legal Uruguay
- **Ley 18.331**: https://www.impo.com.uy/bases/leyes/18331-2008
- **Ley 20.327**: https://www.impo.com.uy/bases/leyes/20327-2024
- **AGESIC**: https://www.gub.uy/agencia-gobierno-electronico-sociedad-informacion-conocimiento/

---

> **âš ï¸ Descargo Legal**: Este informe se presenta Ãºnicamente con fines educativos y de concientizaciÃ³n sobre seguridad informÃ¡tica. Todas las actividades de testing se realizaron dentro del marco de la investigaciÃ³n responsable de vulnerabilidades. No se accediÃ³, almacenÃ³ o distribuyÃ³ informaciÃ³n personal de ciudadanos durante la investigaciÃ³n.

---

**ğŸ“… Documento preparado**: Agosto 2025  
**ğŸ‘¨â€ğŸ’» Investigador responsable**: [REDACTADO]  
**ğŸ” MetodologÃ­a**: Ethical Hacking & Responsible Disclosure  
**ğŸ“‹ Estado actual**: Vulnerabilidad mitigada por el ente gubernamental
